---
phase: 3
plan: 3.2
wave: 3
---

# Plan 3.2: Automated Email Onboarding via Resend

## Objective
Integrate the Resend API to trigger automated welcome emails when an Admin creates a generic new user, completing REQ-08.

## Context
Load these files for context:
- .gsd/SPEC.md
- .gsd/REQUIREMENTS.md
- api/users/index.ts

## Tasks

<task type="auto">
  <name>Install Resend and Update Environment Variables</name>
  <files>
    package.json
    .env
  </files>
  <action>
    Add `resend` as a backend dependency via `npm install resend` or add it to `package.json`.
    Ensure `RESEND_API_KEY` is loaded and validated via `dotenv`.
  </action>
  <verify>grep resend package.json</verify>
  <done>Resend library available in the environment.</done>
</task>

<task type="auto">
  <name>Integrate Email Trigger in User Creation</name>
  <files>
    api/users/index.ts
    src/lib/email.ts
  </files>
  <action>
    Create an email service utility (`src/lib/email.ts`) or instantiate `Resend` directly into the endpoint.
    When a `POST` request to `/api/users` is successfully completed, send an email to the new user's email address providing a welcome message and onboarding instructions.
    Do not block the HTTP response if the email fails, but log the error appropriately.
  </action>
  <verify>Attempt creating a user while mocking out the email send function.</verify>
  <done>Email onboarding triggered successfully on User Creation.</done>
</task>

## Success Criteria
- [ ] New agents/managers receive a welcome email with system instructions.
- [ ] Email delivery failure does not crash the overall user creation flow.
