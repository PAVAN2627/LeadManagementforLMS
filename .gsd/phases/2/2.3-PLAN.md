---
phase: 2
plan: 2.3
wave: 2
---

# Plan 2.3: Frontend Data Integration

## Objective
Update the frontend Dashboard and Leads tables to fetch data from the new `/api/leads` and `/api/users` endpoints- [x] Create API Service `src/lib/api.ts`
- [x] Integrate Admin Dashboard `src/pages/admin/AdminDashboard.tsx`, `src/pages/admin/AdminLeads.tsx`
- [ ] Integrate Agent/Manager Dashboardsx (for token)

## Context
- src/pages/admin/AdminDashboard.tsx
- src/pages/admin/AdminLeads.tsx
- src/context/AuthContext.tsx (for token)

## Tasks

<task type="auto">
  <name>Create API Service</name>
  <files>src/lib/api.ts</files>
  <action>
    Create utility functions for data fetching:
    - `fetchLeads()`
    - `createLead(data)`
    - `updateLead(id, data)`
    - `deleteLead(id)`
    
    Should automatically attach `Authorization: Bearer token` from localStorage or context.
  </action>
  <verify>test -f src/lib/api.ts</verify>
  <done>API fetch wrapper created.</done>
</task>

<task type="auto">
  <name>Integrate Admin Dashboard</name>
  <files>src/pages/admin/AdminDashboard.tsx, src/pages/admin/AdminLeads.tsx</files>
  <action>
    1. Replace `mockLeads` import with `useQuery` (React Query) fetching `fetchLeads`.
    2. Handle loading/error states.
    3. Pass real data to `LeadsTable`.
  </action>
  <verify>grep "useQuery" src/pages/admin/AdminLeads.tsx</verify>
  <done>Admin pages load real data.</done>
</task>

<task type="auto">
  <name>Integrate Agent/Manager Dashboards</name>
  <files>src/pages/agent/MyLeads.tsx, src/pages/manager/ManagerLeads.tsx</files>
  <action>
    Repeat integration for Manager and Agent views.
    Ensure API returns correct filtered data (verified by 2.1 implementation).
  </action>
  <verify>grep "useQuery" src/pages/agent/MyLeads.tsx</verify>
  <done>All role dashboards use live data.</done>
</task>

## Success Criteria
- [ ] No direct imports of `src/data/mockData.ts` in page components for Leads.
- [ ] Dashboards display data from MongoDB.
- [ ] Loading states user experience is smooth.
